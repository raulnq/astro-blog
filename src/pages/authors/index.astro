---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import { getAllAuthors, getPostsByAuthor } from '../../utils/posts';

const posts = await getCollection('blog');
const authors = getAllAuthors(posts);
const authorCounts = authors.map(author => ({
  name: author,
  count: getPostsByAuthor(posts, author).length
})).sort((a, b) => b.count - a.count);
---

<BaseLayout title="Authors">
  <h1 class="text-4xl font-bold mb-8 text-gray-900 dark:text-white">Authors</h1>

  <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
    {authorCounts.map(({ name, count }) => (
      <a
        href={`/authors/${name}`}
        class="p-4 bg-gray-100 dark:bg-gray-800 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors"
      >
        <div class="flex items-center justify-between">
          <span class="text-lg font-medium text-gray-900 dark:text-white">{name}</span>
          <span class="text-sm text-gray-600 dark:text-gray-400">{count} posts</span>
        </div>
      </a>
    ))}
  </div>
</BaseLayout>
